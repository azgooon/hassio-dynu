# Home Assistant Add-on: Dynu {d}DNS

## Installation

Follow these steps to get the add-on installed on your system:

1. Navigate in your Home Assistant frontend to **Supervisor** -> **Add-on Store**.
2. Find the "Dynu" add-on and click it.
3. Click on the "INSTALL" button.

## How to use

1. Visit [dynu.com](https://www.dynu.com/) and create an account.
2. In the `Control Panel` section, select `DDNS Services`, then press `+ Add` button
3. Decide whether to register a subdomain in one of the Dynu top domain or register your own domain.
3. If registration was a success, the configuration page with the subdomain or your domain is displayed along with `current ip` being the public IP address of the device you are currently using to access `dynu.com`. The IP address will be updated by the Dynu add-on.
4. In the Dynu add-on configuration, perform the following:
	- For security reasons, Dynu allow you to create `IP update password` which can be used instead of the main account `password` to update your public IP address. This can be done in [Manage credentials](https://www.dynu.com/en-US/ControlPanel/ManageCredentials) section.
	- Copy your `username` and past into the `username` option.
	- Use your `password` or `IP update password` in the `password` option.
	- Generate new or refresh existing OAuth2 `Client ID` and `Secret` in [API Credentials](https://www.dynu.com/en-US/ControlPanel/APICredentials).
    - Copy the `Client ID` and `Secret` values from the `API Credentials` and paste into the `client` and `secret` options within `oauth2` section.
    - Update the `domains` option with the full domain name you registered. E.g., `my-domain.com` or `my-dynu-subdomain.ddnsfree.com`.

## Configuration

Add-on configuration:

```yaml
lets_encrypt:
  accept_terms: true
  certfile: fullchain.pem
  keyfile: privkey.pem
username: jamesd
password: 098f6bcd4621d373cade4e832627b4f6
oauth2:
  client: ********************************e20d
  secret: **************************12UY
domains:
  - my-domain.com
seconds: 300
```

Additionally, you'll need to configure the Home Assistant Core to pick up the SSL certificates. This is done by setting the following configuration for the [HTTP][HTTP] integration configuration in your `configuration.yaml`:

```yaml
http:
  ssl_certificate: /ssl/fullchain.pem
  ssl_key: /ssl/privkey.pem
```

### Option group `lets_encrypt`

The following options are for the option group: `lets_encrypt`. These settings
only apply to Let's Encrypt SSL certificates.

#### Option `lets_encrypt.accept_terms`

Once you have read and accepted the Let's Encrypt[Subscriber Agreement](https://letsencrypt.org/repository/), change value to `true` in order to use Let's Encrypt services.

#### Option `lets_encrypt.certfile`

The name of the certificate file generated by Let's Encrypt. The file is used for SSL by Home Assistant add-ons and is recommended to keep the filename as-is (`fullchain.pem`) for compatibility.

**Note**: _The file is stored in `/ssl/`, which is the default for Home Assistant_

#### Option `lets_encrypt.keyfile`

The name of the private key file generated by Let's Encrypt. The private key file is used for SSL by Home Assistant add-ons and is recommended to keep the filename as-is (`privkey.pem`) for compatibility.

**Note**: _The file is stored in `/ssl/`, which is the default for Home Assistant_

### Option: `ipv4` (optional)

By default, Dynu will auto detect your IPv4 address and use that.
This option allows you to override the auto-detection and specify an
IPv4 address manually.

If you specify a URL here, contents of the resource it points to will be
fetched and used as the address. This enables getting the address using
a service like https://api.ipify.org/ or https://ipv4.text.wtfismyip.com

### Option: `ipv6` (optional)

By default, Dynu will auto detect your IPv6 address and use that.
This option allows you to override the auto-detection and specify an
IPv6 address manually.

If you specify a URL here, contents of the resource it points to will be
fetched and used as the address. This enables getting the address using
a service like https://api6.ipify.org/ or https://ipv6.text.wtfismyip.com

### Option: `username`

The Dynu username will be used together with the password to update IP address associated with the domain.

### Option: `password`

The Dynu password will be used together with the username to update IP address associated with the domain.

### Option: `oauth2.client`

The Dynu clientId will be used together with the secret to obtain access token needed to manipulate domain records.

### Option: `oauth2.secret`

The Dynu secret will be used together with the clientId to obtain access token needed to manipulate domain records.

### Option: `domains`

A list of Dynu domains or subdomains registered under your account. 

Don't add your custom domain name to the `domains` array. For certificate creation, all unique domains and aliases are used.

### Option: `seconds`

The number of seconds to wait before updating Dynu domains and renewing Let's Encrypt certificates.

## Known issues and limitations

- Fixed waiting time of 30 seconds after creating TXT record and before proceeding with the challange.



In case you've found a bug, please [open an issue on our GitHub][issue].

[dynu]: https://dynu.com
[dynu-faq]: https://www.dynu.com/en-US/Resources/FAQ
[dynu-tutorials]: https://www.dynu.com/en-US/Resources/Tutorials
[HTTP]: https://www.home-assistant.io/integrations/http/
